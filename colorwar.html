<head>
   <link rel="icon" type="image/jpeg" href="coloro.jpeg">
   <title>color war</title>
  <link rel="stylesheet" href="styles.css">
  <style>
    body {
        font-family: Arial;
        background-color: #303036;
       color: #000000;
        font-size:18px;
        padding:1.5%;
        text-align: left;
        overflow: auto;
      transition: 200ms;
    }
    button {
      font-size: 4vmin;
      padding: 1.5vmin 2.5vmin;
      border-radius: 2px;
      margin: 2px;
    }
    .a {
      background-color: #ff5f5f;
    }
    .b {
      background-color: #7f7fff;
    }
    .c {
      background-color: #7fff7f;
    }
    .d {
      background-color: #ffaf3f;
    }
    .e {
      color: red;
    }
    .f {
      color: blue;
    }
    .g {
      color: green;
    }
    .h {
      color: orange;
    }
  </style>
</head>
<div style="background-color: white">This is a recreation of Color Wars from 2 Player Games by Jindoblu
  <p id="gameinfodisp">GAME INFO:</p>
</div>
<div id="gameplay"></div>
<script>
  arena = document.getElementById("gameplay");
   const thingis = [
      "dummy",
      "RED",
      "BLUE",
      "GREEN",
      "ORANGE",
      "PLAYER 5",
      "PLAYER 6",
      "PLAYER 7",
      "PLAYER 8"
   ];
size = 7;
player = 1;
players_max = 4;
var players_list = [];
turn = 1;
clear();
draw();
draw();
function draw() {
  arena.innerHTML = "";
  for (i=0;i<size;i++) {
  for (j=0;j<size;j++){
    if (color[j+size*i] == 1) {
      arena.innerHTML += "<button class=a onclick='addis_ababa(" + (j+size*i) +")'>" + data[j+size*i] + "</button>";
    } else if (color[j+size*i] == 2) {
      arena.innerHTML += "<button class=b onclick='addis_ababa(" + (j+size*i) +")'>" + data[j+size*i] + "</button>";
    } else if (color[j+size*i] == 3) {
      arena.innerHTML += "<button class=c onclick='addis_ababa(" + (j+size*i) +")'>" + data[j+size*i] + "</button>";
    } else if (color[j+size*i] == 4) {
      arena.innerHTML += "<button class=d onclick='addis_ababa(" + (j+size*i) +")'>" + data[j+size*i] + "</button>";
    } else if (color[j+size*i] == 5) {
      arena.innerHTML += "<button class=e onclick='addis_ababa(" + (j+size*i) +")'>" + data[j+size*i] + "</button>";
    } else if (color[j+size*i] == 6) {
      arena.innerHTML += "<button class=f onclick='addis_ababa(" + (j+size*i) +")'>" + data[j+size*i] + "</button>";
    } else if (color[j+size*i] == 7) {
      arena.innerHTML += "<button class=g onclick='addis_ababa(" + (j+size*i) +")'>" + data[j+size*i] + "</button>";
    } else if (color[j+size*i] == 8) {
      arena.innerHTML += "<button class=h onclick='addis_ababa(" + (j+size*i) +")'>" + data[j+size*i] + "</button>";
    } else if (color[j+size*i] == 0) {
      arena.innerHTML += "<button onclick='addis_ababa(" + (j+size*i) +")'>" + data[j+size*i] + "</button>";
    }
  }
  arena.innerHTML += "<br>";
}
document.getElementById("gameinfodisp").innerHTML = "PLAYERS: ";
for (i=0; i<players_list.length; i++) {
   document.getElementById("gameinfodisp").innerHTML += thingis[players_list[i]] + ", ";
}
document.getElementById("gameinfodisp").innerHTML +="<br>TURN: " + thingis[players_list[player]];
}
function addis_ababa(q) {
  
  if (color[q] == 0 || color[q] == players_list[player]) {
    data[q]++;
    color[q] = players_list[player];
    
  
  }
  for (iw=0; iw<(size);iw++) {
    for (i=0; i<(size*size);i++) {
      spread_check(i);
      flagged[i] = 0;
    }
  }
  if (color[q] == 0 || color[q] == players_list[player]) {
      turn++;
    handleTurns();
  }
  
  draw();
}
function handleTurns() {
  if (player > players_max - 1) {
    player = 0;
  } else if (players_max > 1) {
    player = ((player+1)%players_list.length);
  }
  if (players_list[player] == 1) {
    document.body.style.background = "#ff2000";
  } else if (players_list[player] == 4) {
    document.body.style.background = "#ffaf00";
  } else if (players_list[player] == 3) {
    document.body.style.background = "#00ff00";
  } else if (players_list[player] == 2) {
    document.body.style.background = "#003fff";
  }
  draw();
}
function spread_check(q) {
  if (data[q] >= 4) {
    flagged[q] = 1;
    add(q+1,q);
    add(q-1,q);
    add(q+size,q);
    add(q-size,q);
    data[q] = 0;
    color[q]= 0;
    outcheck();
  }
}
function outcheck() {
  let squares = 0;
  let modificator = 0;
  for (b=0; b<players_list.length; b++) {
    if (turn > players_max) {
    for (i=0; i<(size*size); i++) {
      if (color[i] == players_list[b-modificator]) {
        squares++;
    }
  }
  
  if (squares <= 0) {
    players_list = players_list.toSpliced((players_list.length+b)%players_list.length,1);
     //modificator++;
     console.log(b);
  }
  squares = 0;
  }
  }
    //remove player
}
function add(st,st1) {
  if (!flagged[st]) {
    data[st]++;
    color[st] = color[st1];
  }
}
function clear() {
  turn = 1;
  data = [
  0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,
];  
color = [
  0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,
];
flagged = [
  0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,
];
draw();
player = 0;
players_max = ((parseInt(prompt("# of players? (1-8)"))-1)%8)+1;
size = ((parseInt(prompt("Board size (1-10)"))-1)%10)+1;
   players_list = [];
for (i=1; i<=players_max; i++) {
   players_list.push(i);
}
}

document.addEventListener("keydown",function() {
if (event.code == "KeyC") {
  clear();
}
if (event.code == "KeyZ") {
  handleTurns();
}
});
</script>
