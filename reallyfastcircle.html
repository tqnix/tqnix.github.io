<head>
       <meta charset="UTF-16">
   <link rel="icon" type="image/jpeg" href="coloro.jpeg">
  <link rel="stylesheet" href="styles.css">
<title>Draw a Really Fast Circle</title>
<style>
  body {
        font-family: Arial;
        background: #000000;
        
        color: #ffffcd;
        font-size:3vh;
        margin: 0;
        padding: 0;
        text-align: left;
    }
  a {
    color: royalblue;
  }
.pianoforte {
  padding: 0;
  margin: 0;
display: flex;
  
  height: 100vh;
  width: 100vw;
  position: fixed;
  justify-content: center;
  pointer-events: none;
  cursor: not-allowed;
  
}
  .marcato {
    padding: 0;
  margin: 0;
  
  height: 100vh;
  width: 100vw;
  position: fixed;
  text-align: center;
  pointer-events: none;
  cursor: not-allowed;
  }
.cantabile {
  justify-content: center;
  align-items: center;
  font-size: 10vmax;
  margin: 0;
  padding: 0;
}
.diin {
  align-items: flex-end;
  pointer-events: none;
  justify-content: center;
}
  .bayashi {
    font-size: 9vh;
  }
   .bayashimi {
    font-size: 6vh;
     font-weight: bold;
  }
button {
  position: fixed;
}
  #kaap {
    background: radial-gradient(circle,rgba(0, 0, 0, 1) 5%, rgba(28, 28, 28, 1) 100%);
  }
</style>
</head>
<body>
<canvas id="kaap" class= "pianoforte"></canvas>
<div id="seer" class="marcato"><br>
  <a href="">Inspired by Draw a Perfect Circle</a><br>
  <span class="bayashimi">Draw a Really Fast Circle</span>
  
</div>
<div id="seng-btrony" class="pianoforte diin">
  HOLD LEFT CLICK to<br>Start drawing circles<br>around me!
</div>
<div id="seng-osu" class="pianoforte diin bayashi">
</div>
<div id="seng-idiwere" class="pianoforte cantabile">
  ©
</div>
<button class="navbutton" onclick="window.location.href = 'index.html'">◀️Back</button>
</body>
<script>
  const canvas = document.getElementById("kaap");
const ctx = canvas.getContext("2d");

ctx.canvas.width  = window.innerWidth;
ctx.canvas.height = window.innerHeight;
ctx.lineWidth = 5;
previousangle = 77;
cumulangle = 0;
spin_speed = 0;
high_spin_speed = 0;
at_high_spin_speed = 0;
drawflag = false;
duffel = [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];
var thisFrameTime = 1000;
var filterStrength = 20;
var frameTime = 0, lastLoop = new Date, thisLoop;
var lastS = 0, thisS;
main = document.getElementById("seng-btrony");
  
document.addEventListener('mousedown', (event) => {
  drawflag = true;
  mx = event.clientX + window.pageXOffset;
    my = event.clientY + window.pageYOffset;
main = document.getElementById("seng-btrony");
spin = document.getElementById("seng-idiwere");


if (drawflag) {
  spin.style.transform = 'rotate('+ toro(mx,my) +'rad)';
spin_speed++;
if (spin_speed > high_spin_speed) {
  high_spin_speed = spin_speed;
}
  ctx.lineTo(mx,my);
ctx.stroke();
ctx.beginPath();
ctx.moveTo(mx,my);
}
});


document.addEventListener('mouseup', (event) => {
  previousangle = 77;
  drawflag = false;

spin_speed = 0;
  
duffel = [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];
  cumulangle = 0;
});

document.addEventListener('keypress', (event) => {
  if (event.repeat) { return 0;}
  drawflag = true;
  mx = event.clientX + window.pageXOffset;
    my = event.clientY + window.pageYOffset;
main = document.getElementById("seng-btrony");
spin = document.getElementById("seng-idiwere");


if (drawflag) {
  spin.style.transform = 'rotate('+ toro(mx,my) +'rad)';
spin_speed++;
if (spin_speed > high_spin_speed) {
  high_spin_speed = spin_speed;
}
  ctx.lineTo(mx,my);
ctx.stroke();
ctx.beginPath();
ctx.moveTo(mx,my);
}
});


document.addEventListener('keyup', (event) => {
  previousangle = 77;
  drawflag = false;
spin_speed = 0;
duffel = [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];
  cumulangle = 0;
  
});
  
document.addEventListener('mousemove', (event) => {
  gameLoop();
  
  mx = event.clientX + window.pageXOffset;
    my = event.clientY + window.pageYOffset;
main = document.getElementById("seng-btrony");
spin = document.getElementById("seng-idiwere");
if (drawflag) {
  spin.style.transform = 'rotate('+ toro(mx,my) +'rad)';
    if (previousangle != 77 && Math.abs((toro(mx,my) - previousangle)) < Math.PI*2/3) {
      duffelLoop();
      cumulangle += Math.abs((toro(mx,my) - previousangle));
      if (cumulangle > 31.41) {
        document.getElementById("seng-osu").innerHTML = Math.floor(cumulangle/20*Math.PI)*1000-4000 + "<br><br><br>";
      } else {
        document.getElementById("seng-osu").innerHTML = "<br><br><br>";
        console.log(cumulangle);
      }
} else if (previousangle == 77) {
            ctx.canvas.width  = window.innerWidth;
ctx.canvas.height = window.innerHeight;
        ctx.strokeStyle = "#303038";
        ctx.lineWidth = 5;
  high_spin_speed = 0;
}
  previousangle = toro(mx,my);
if (spin_speed > high_spin_speed) {
  high_spin_speed = spin_speed;
}
  if (spin_speed > at_high_spin_speed) {
  at_high_spin_speed = spin_speed;
}
if (Math.floor(spin_speed) >= 477) {
    main.style.color = "#30ffff";
    ctx.strokeStyle = "#30ffff";
  } else if (Math.floor(spin_speed) >= 400) {
    main.style.color = "#30ff38";
    ctx.strokeStyle = "#30cf38";
  } else if (Math.floor(spin_speed) >= 277) {
    main.style.color = "#ffff00";
    ctx.strokeStyle = "#7f7f7f";
  }else {
    
    main.style.color = "#afafaf";
    ctx.strokeStyle = "#3f3f3f";
  }
  ctx.lineTo(mx,my);
ctx.stroke();
ctx.beginPath();
ctx.moveTo(mx,my);
}
});
s = setInterval(function () {//fix
  main.innerHTML = "SPIN: " + Math.floor(spin_speed) + "rpm<br>HIGH: " + Math.floor(high_spin_speed) + " | " + Math.floor(at_high_spin_speed);
}, 100);
function toxy(radius,radian){
    return {
        x:radius*Math.cos(radian),
        y:radius*Math.sin(radian)
    }
}
function toro(x,y) {
  return Math.atan2(y-window.innerHeight/2, x-window.innerWidth/2)+3.1415926535*1/2;
}
function gameLoop(){
  // ...
  thisFrameTime = (thisLoop=new Date) - lastLoop;
  frameTime+= (thisFrameTime - frameTime) / filterStrength;
  lastLoop = thisLoop;
  
}

function duffelLoop () {
  ddff = Math.abs((toro(event.clientX,event.clientY) - previousangle))*60000/(2*Math.PI*thisFrameTime);
  ddff_a = duffel[0] + duffel[1] + duffel[2] + duffel[3] + duffel[4] + duffel[5] + duffel[6] + duffel[7] + duffel[8] + duffel[9] + duffel[10] + duffel[11] + duffel[12] + duffel[13] + duffel[14] + duffel[15] + duffel[16] + duffel[17] + duffel[18] + duffel[19];
  spin_speed = ddff_a/20;
  duffel.push(ddff);
  duffel.shift();
}
function touch2Mouse(e)
{
  var theTouch = e.changedTouches[0];
  var mouseEv;
  if (e.changedTouches[1] != null) {
    tianxue.style.display = "flex";
  }

  switch(e.type)
  {
    case "touchstart": mouseEv="mousedown"; break;  
    case "touchend":   mouseEv="mouseup"; break;
    case "touchmove":  mouseEv="mousemove"; break;
    default: return;
  }

  var mouseEvent = document.createEvent("MouseEvent");
  mouseEvent.initMouseEvent(mouseEv, true, true, window, 1, theTouch.screenX, theTouch.screenY, theTouch.clientX, theTouch.clientY, false, false, false, false, 0, null);
  theTouch.target.dispatchEvent(mouseEvent);

  e.preventDefault();
}
document.addEventListener("touchstart", touch2Mouse, true);
document.addEventListener("touchmove", touch2Mouse, true);
document.addEventListener("touchend", touch2Mouse, true);
</script>







